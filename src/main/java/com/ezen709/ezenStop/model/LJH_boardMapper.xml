<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
 PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
 "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ezen709.ezenStop.model">
	<select id="noticeList" parameterType="java.util.Map" resultType="ReviewBoardDTO">
		select *
		from(
				select rownum rn, A.*
				from(
						select B.* , ezen_member.grade
						from ${tableName} B, ezen_member
						where ((B.id = ezen_member.id) and (B.visible = 1))
						order by B.article_num desc)A
					)
		where rn between #{start} and #{end}
	</select>
 	<select id="A_GetCount" parameterType="java.util.Map" resultType="Integer">
 		select count(*) from ${tableName}
 	</select>
 	
 	 <insert id="noticeInsert" parameterType="reviewBoardDTO">
 		insert into ezen_notice_board 
 		values (ezen_board_seq.nextval, #{category}, #{subject}, #{id}, #{content}, 
 		to_char(sysdate,'yyyy-mm-dd'), to_char(sysdate,'hh24:mi'), 0, 0, 0, 0, 'notice_detail.board', 1, #{image}, #{filesize})
 	</insert>
 	 <insert id="tradeInsert" parameterType="reviewBoardDTO">
 		insert into ezen_trade_board 
 		values (ezen_board_seq.nextval, #{category}, #{subject}, #{id}, #{content}, 
 		to_char(sysdate,'yyyy-mm-dd'), to_char(sysdate,'hh24:mi'), 0, 0, 0, 0, 'notice_detail.board', 1, #{image}, #{filesize})
 	</insert>
 	
 	 <update id="A_plusReadCount" parameterType="java.util.Map">
 		update ${tableName}
 		set readcount = readcount + 1 
 		where article_num = #{article_num}
 	</update>
 	
 	<select id="A_Detail" parameterType="Integer" resultType="ReviewBoardDTO">
 		select A.*, ezen_member.grade , ezen_member.academylocation
 		from ${tableName} A , ezen_member
 		where ((A.id = ezen_member.id) and (article_num = #{article_num}))
 	</select>
 	<delete id="A_Delete" parameterType="java.util.Map">
 		delete
 		from ${tableName}
 		where article_num = #{article_num}
 	</delete>
 	<update id="A_fileDelete" parameterType="java.util.Map">
 		update ${tableName}
 		set image = '파일없음', filesize = 0
 		where article_num = #{article_num}
 	</update>
 	<update id="noticeEdit" parameterType="ReviewBoardDTO">
 		update ezen_notice_Board
 		set category = #{category}, subject = #{subject}, content = #{content}, image = #{image}, filesize = #{filesize}
 		where article_num = #{article_num}
 	</update>
 	 <update id="tradeEdit" parameterType="ReviewBoardDTO">
 		update ezen_notice_Board
 		set category = #{category}, subject = #{subject}, content = #{content}, image = #{image}, filesize = #{filesize}
 		where article_num = #{article_num}
 	</update>
 		<select id="A_searchList" parameterType="java.util.Map" resultType="ReviewBoardDTO">
  		select * 
  		from (
			select rownum rn, A.* 
			from (
		 		select B.* , ezen_member.grade, ezen_member.academylocation
		 		from ${tableName} B, ezen_member 
		 		where ((B.id = ezen_member.id) and (B.${searchtype} like #{searchstring}) and (visible = 1))
		 		order by B.article_num desc)A
		 	)
		 where rn between #{start} and #{end}
	</select>
	<select id="A_searchGetCount" parameterType="java.util.Map" resultType="Integer">
	 	select count(*)	
	 	from ${tableName} 
	 	where ${searchtype} like #{searchstring} and visible = 1
	</select>
 	
 	<update id="A_changeVisibleStatus" parameterType="java.util.Map">
 		update ${tableName}
 		set visible = (visible * -1)
 		where article_num = #{article_num}
 	</update>
</mapper>